openapi: 3.0.1
info:
  description: Magnit Post service API
  title: Magnit Post service API
  version: 1.0.6

servers:
  - url: https://b2b-api-gateway.uat.ya.magnit.ru/
    description: Демо сервер для проведения тестирования интеграции.
  - url: https://b2b-api.magnit.ru/
    description: Основной сервер интеграции.
security:
  - bearerAuth: []

paths:
  /api/v2/oauth/token:
    post:
      summary: Получение аутентификационного токена
      description: |
        Запросите новый токен 1 раз за 60 минут. Запрашивать токен перед каждым запросом к API-методам не требуется. Ссылка на полную спецификацию OAuth2 - https://tools.ietf.org/html/rfc6749"
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/OauthRequest'
      responses:
        200:
          description: Успешный ответ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OauthToken"
        400:
          description: Ошибка в параметрах, в ответе список ошибок валидации
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OauthError'
        401:
          description: "Ошибка авторизации. В запросе не указан или указан несуществующий client_id"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OauthError'
        500:
          description: 'Internal Server Error'
        503:
          description: 'Internal Server Error'

  /api/v1/magnit-post/order-statuses:
    post:
      description: Метод позволяет получить актуальные статусы заказов на доставку, передав список этих заказов.
      summary: Получить актуальные статусы по нескольким заказам
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - trackingNumbers
              properties:
                trackingNumbers:
                  type: array
                  items:
                    $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: "OK"
          content:
            "application/json":
              schema:
                $ref: "#/components/schemas/GetOrderStatusesResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v1/magnit-post/orders:
    post:
      summary: Создать заказ
      description: Метод позволяет создать новый заказ на доставку.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrderRequest"
      responses:
        "201":
          description: "OK"
          content:
            "application/json":
              schema:
                $ref: "#/components/schemas/CreateOrderResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          description: "Unauthorized"
        "500":
          $ref: "#/components/responses/ErrorResponse"
    get:
      summary: Получить список заказов
      description: Метод позволяет получить список заказов с фильтрами, сортировкой и пагинацией.
      parameters:
        - $ref: "#/components/parameters/pageNumber"
        - $ref: "#/components/parameters/pageSize"
        - $ref: "#/components/parameters/CustomerOrderID"
        - $ref: "#/components/parameters/ExternalOrderID"
        - $ref: "#/components/parameters/StatusParam"
        - $ref: "#/components/parameters/CreatedFrom"
        - $ref: "#/components/parameters/CreatedTo"
        - $ref: "#/components/parameters/SortDirection"
      responses:
        "200":
          description: "OK"
          content:
            "application/json":
              schema:
                $ref: "#/components/schemas/GetOrdersResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v2/magnit-post/orders/estimate:
    post:
      summary: Расчет срока и стоимости доставки
      description: |
        ### Метод позволяет оценить время и стоимость доставки заказа.

        city_from - обазятельное поле, город отправки.

        Доступные значения:

        - Казань
        - Москва
        - Екатеринбург
        - Ижевск
        - Магнитогорск
        - Оренбург
        - Саратов
        - Регионы

        Для городов МО используется значение "Москва", для всех остальных не из списка - "Регионы"

      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EstimateOrderRequestBody"
      responses:
        "200":
          description: "OK"
          content:
            "application/json":
              schema:
                $ref: "#/components/schemas/EstimateOrderResponseBody"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          description: "Unauthorized"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v1/magnit-post/orders/{order_id}:
    get:
      summary: Получить заказ по ID
      description: Метод позволяет получить данные заказа по его идентификатору.
      parameters:
        - name: order_id
          in: path
          required: true
          description: Идентификатор заказа
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: "OK"
          content:
            "application/json":
              schema:
                $ref: "#/components/schemas/Order"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "404":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"
    delete:
      summary: Отменить заказ по ID
      description: Метод позволяет отменить заказ по его идентификатору.
      parameters:
        - name: order_id
          in: path
          required: true
          description: Идентификатор заказа
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: "Заказ отменен"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "404":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v1/magnit-post/orders/{order_id}/status-history:
    get:
      summary: Получить историю статусов заказа
      description: Метод позволяет получить историю изменения статусов заказа на доставку по его идентификатору.
      parameters:
        - name: order_id
          in: path
          required: true
          description: Идентификатор заказа
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: История изменения статусов заказа
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeliveryOrderHistoryResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "404":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v1/magnit-post/pickup-points:
    get:
      summary: Получить список пунктов выдачи заказов
      description: Метод позволяет получить список активных пунктов выдачи заказов.
      parameters:
        - $ref: "#/components/parameters/pageNumber"
        - $ref: "#/components/parameters/pageSize"
        - $ref: '#/components/parameters/pickupPointKey'
        - $ref: '#/components/parameters/region'
        - $ref: '#/components/parameters/city'
      responses:
        "200":
          description: "OK"
          content:
            'application/json':
              schema:
                $ref: "#/components/schemas/PickupPointsResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v1/magnit-post/warehouses:
    post:
      summary: Создать склад партнёра
      description: Метод позволяет создать новый склад для партнёра.
      requestBody:
        $ref: "#/components/requestBodies/CreateWarehouseRequest"
      responses:
        "200":
          description: "OK"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateWarehouseResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"
    get:
      summary: Получить склады партнёра
      description: Метод возвращает список всех складов партнёра.
      responses:
        "200":
          description: Список складов
          content:
            application/json:
              schema:
                type: array
                maxItems: 1000
                items:
                  $ref: "#/components/schemas/GetWarehouseResponse"
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"
    put:
      summary: Обновить склад партнёра
      description: Метод позволяет обновить данные склада партнёра.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateWarehouseRequest"
      responses:
        "204":
          description: Склад успешно обновлён
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "404":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

  /api/v1/magnit-post/orders/{order_id}/labels:
    get:
      summary: Получить PDF-этикетку посылки
      description: Метод возвращает PDF-файл с этикеткой по трек-номеру заказа.
      parameters:
        - name: order_id
          in: path
          required: true
          description: Идентификатор заказа
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: PDF с этикеткой
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        "400":
          $ref: "#/components/responses/ErrorResponse"
        "401":
          $ref: "#/components/responses/ErrorResponse"
        "404":
          $ref: "#/components/responses/ErrorResponse"
        "500":
          $ref: "#/components/responses/ErrorResponse"

components:
  parameters:
    pageNumber:
      name: page
      in: query
      required: false
      description: Номер страницы, начинающийся с единицы (1..N)
      schema:
        type: integer
        format: int32
        minimum: 1
        default: 1

    pageSize:
      name: size
      in: query
      required: false
      description: Размер возвращаемой страницы
      schema:
        type: integer
        format: int32
        minimum: 1
        maximum: 1000
        default: 100

    pickupPointKey:
      name: key
      in: query
      description: Ключ пункта выдачи заказа
      required: false
      schema:
        type: string
        example: "63933"

    region:
      name: region
      in: query
      description: Регион ПВЗ
      required: false
      schema:
        type: string
        example: "Татарстан"

    city:
      name: city
      in: query
      description: Город ПВЗ
      required: false
      schema:
        type: string
        example: "Казань"

    CustomerOrderID:
      in: query
      name: customerOrderId
      schema:
        type: string
      required: false
      description: Фильтр по идентификатору заказа в системе отправителя

    ExternalOrderID:
      in: query
      name: externalOrderId
      schema:
        type: string
      required: false
      description: Фильтр по внешнему идентификатору заказа

    StatusParam:
      in: query
      name: status
      schema:
        $ref: "#/components/schemas/OrderV1Status"
      required: false
      description: Фильтр по статусу заказа

    CreatedFrom:
      in: query
      name: createdFrom
      schema:
        $ref: "#/components/schemas/DateTime"
      required: false
      description: Дата создания с

    CreatedTo:
      in: query
      name: createdTo
      schema:
        $ref: "#/components/schemas/DateTime"
      required: false
      description: Дата создания по

    SortDirection:
      name: sortDirection
      in: query
      schema:
        type: string
        enum:
          - asc
          - desc
      required: false
      description: "Сортировка по дате создания заказа"

  requestBodies:
    CreateWarehouseRequest:
      description: "Запрос на создание склада"
      required: true
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CreateWarehouseRequest"

  responses:
    ErrorResponse:
      description: "Ошибка"
      content:
        "application/json":
          schema:
            $ref: "#/components/schemas/ErrorResponseBody"

  schemas:
    OauthToken:
      type: object
      required:
        - access_token
        - expires_in
        - scope
        - token_type
      properties:
        access_token:
          type: string
          description: Токен аутентификации
          example: eyJhbGciOiJSUzI1NiIsImtpZCI6IjgyNmRhNjg0LTI5OGItNDRkYy1hYjM1LTkwZDQ4OWQ3MWUxOCIsInR5cCI6IkpXVCJ9.eyJhdWQiOltdLCJjbGllbnRfaWQiOiJkYThiOTUzYi1jNmNjLTRkODgtYTUzZi02MGUzYjBlOTY2MTUiLCJleHAiOjE3MDczOTc5MDIsImV4dCI6eyJmb28iOiJiYXIifSwiaWF0IjoxNzA3Mzk0MzAyLCJpc3MiOiJodHRwOi8vMTI3LjAuMC4xOjQ0NDQiLCJqdGkiOiIwNTdiYWQwMS05YmZjLTQyMTktYTYxMi00NWJjOWY0OWIxNzQiLCJuYmYiOjE3MDczOTQzMDIsInNjcCI6WyJvcGVuaWQiLCJvZmZsaW5lIl0sInN1YiI6ImRhOGI5NTNiLWM2Y2MtNGQ4OC1hNTNmLTYwZTNiMGU5NjYxNSJ9.LN5yR70uw2LlVvaEQC-9oHj0Rr4dtpfO42Ie5OTNmzJCJ40hbB0ncdeje6HrIkKTKbiCrJf-Dnb2j9XMa8ybLQDkqedBG4UN-oJUALeCUS2M6sj2sKAe7B7e_nkF5wz9cuqucR5mbfwa19_xmK517PbMTxX3ZRVuPhKVogNzUFMRSeiFABsXNYVLGB4H5plhP13L4_NkJ6XOzP_wnW207UYIQz2zT97WnhoUPTKQoRWaGw-_CFOtBV6p1oQieXXZIKJ0kJCOD_UVxj2Ume4iKtd4X71GtVnakuB9-JnC7nKZ4UIEYJZ8l70GS-6P1ztElcxE_Xp4xbgxjVQQLro6FiMAiVDwmpWm9aq6Q6uSM971ZZm476N7CUWvEazJ-Ydes-WI0w_scf5GTJIPyqTjYBYH1xrHjt3tjbv5wloUJcRIipeCZreGm8atop0y7YaihKM-AEaVr1-lg45HynDufIoO-hYKUQD48wpg-50gDTItenkMGkKPGkNFkiht80iau93v0g5P5S6AgI3EiW7SUakX5XFRVav5ggjl0BjVDlRZUjReUSbtTer4ShD3Ff_DHMMRzbElnj2vh9sp2UwTeHy_9pCoUiQFBzohAi7whTcydNZtLDAzBw51DWuhuiExZiqqJNoVezqVHMmSjUK4qxXk6YHULhna5KKSROnwJkU
        expires_in:
          type: integer
          format: int64
          description: Время жизни токена в секундах
          example: 3599
        scope:
          type: string
          description: Права доступа
          example: openid last-mile:claims
        token_type:
          type: string
          description: Тип токена
          example: bearer

    OauthRequest:
      type: object
      required:
        - client_id
        - client_secret
        - scope
        - grant_type
      properties:
        client_id:
          type: string
          description: "Идентификатор клиента"
          example: da8b953b-c6cc-4d88-a53f-60e3b0e96615
        client_secret:
          type: string
          description: "Секрет"
          example: 525348e77144a9cee9a7471a8b67c50ea85b9e3eb377a3c1a3a23db88f9150eefe76e6a3
        scope:
          type: string
          description: "Права доступа. Разделитель - пробел"
          example: openid last-mile:claims
        grant_type:
          type: string
          description: "Тип доступа"
          example: client_credentials
          default: client_credentials

    OauthError:
      type: object
      required:
        - error
      properties:
        error:
          type: string
          description: "Код ошибки, кратко описывающий ее причину"
          example: invalid_client
        error_description:
          type: string
          description: "Детальное описание ошибки"
          example: Client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method).
        message:
          type: string
          description: "Системное сообщение"

    UUID:
      type: string
      format: uuid

    ErrorCodes:
      description: Коды ошибок
      type: string
      enum:
        - NOT_FOUND
        - BAD_REQUEST
        - VALIDATION_ERROR
        - INTERNAL_SERVER_ERROR
        - UNPROCESSABLE_ENTITY
        - CONFLICT

    Errors:
      type: object
      required:
        - code
        - message
      properties:
        code:
          $ref: "#/components/schemas/ErrorCodes"
        messages:
          type: array
          maxItems: 100
          items:
            type: string

    ErrorResponseBody:
      oneOf:
        - $ref: "#/components/schemas/Error"
        - $ref: "#/components/schemas/Errors"

    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          $ref: "#/components/schemas/ErrorCodes"
        message:
          type: string

    EstimateOrderRequestBody:
      type: object
      required:
        - city_from
      properties:
        pup_region:
          type: string
          description: "Регион ПВЗ. Обязательно, если не указан pup_key"
        pup_city:
          type: string
          description: "Город ПВЗ. Обязательно, если не указан pup_key"
        pup_key:
          type: string
          description: "Идентификатор ПВЗ. Обязательно, если не указаны pup_region и pup_city"
        pup_name:
          type: string
          description: "Название ПВЗ"
        city_from:
          type: string
          example: Москва
          description: |
            Город отправки. Доступные значения:

            - Казань
            - Москва
            - Воронеж
            - Екатеринбург
            - Ижевск
            - Магнитогорск
            - Оренбург
            - Саратов
            - Регионы

            Для городов МО используется значение "Москва", для всех остальных не из списка - "Регионы"

    EstimateOrderResponseBody:
      type: object
      required:
        - from
        - to
        - cost
      properties:
        from:
          type: integer
          minimum: 0
          description: "Минимальный срок доставки в днях"
        to:
          type: integer
          minimum: 0
          description: "Максимальный срок доставки в днях"
        cost:
          type: integer
          description: "Стоимость доставки в копейках"
          example: 25000

    PickupPointsResponse:
      type: object
      required:
        - pickupPoints
        - pager
      properties:
        pickupPoints:
          type: array
          maxItems: 1000
          items:
            $ref: "#/components/schemas/PickupPoint"
        pager:
          $ref: "#/components/schemas/Pager"

    PickupPoint:
      type: object
      properties:
        key:
          description: Ключ пункта выдачи заказа
          type: string
          example: "63933"
        name:
          description: Наименование ПВЗ
          type: string
          example: Двуреченка
        type:
          description: Тип пункта выдачи заказов
          type: string
          example: MAGNIT_COSMETICS
        address:
          description: Адрес пункта выдачи заказов
          type: string
          example: "г. Казань, ул. Альфии Авзаловой, д. 7 (Магнит Косметик)"
        region:
          description: Регион, в котором находится ПВЗ
          type: string
          example: "Республика Татарстан"
        city:
          description: Город, в котором находится ПВЗ
          type: string
          example: "Казань"
        index:
          description: Почтовый индекс пункта выдачи заказов
          type: string
          example: "420076"
        workHours:
          $ref: "#/components/schemas/WorkHours"
        coordinates:
          $ref: "#/components/schemas/PickupPointCoordinates"

    PickupPointCoordinates:
      type: object
      properties:
        latitude:
          description: Широта
          type: number
          format: double
          minimum: -90
          maximum: 90
          example: 55.858563
        longitude:
          description: Долгота
          type: number
          format: double
          minimum: -180
          maximum: 180
          example: 48.904931

    WorkHours:
      type: array
      description: Расписание работы ПВЗ
      items:
        $ref: "#/components/schemas/DayWorkHours"
      minItems: 1
      maxItems: 7

    DayWorkHours:
      type: object
      description: Часы работы
      properties:
        day:
          $ref: "#/components/schemas/Week"
        from:
          description: Открытие
          type: string
          example: "08:00"
        till:
          description: Закрытие
          type: string
          example: "20:00"

    Week:
      type: string
      description: День недели
      enum: [ MON, TUE, WED, THU, FRI, SAT, SUN ]

    Pager:
      type: object
      required:
        - totalItems
        - currentPage
        - pageSize
        - totalPages
      properties:
        totalItems:
          description: Всего записей в коллекции
          type: integer
          format: int32
          minimum: 0
          example: 30
        totalPages:
          description: Количество страниц
          type: integer
          format: int32
          minimum: 1
          example: 2
        currentPage:
          description: Номер страницы
          type: integer
          format: int32
          minimum: 1
          example: 1
        pageSize:
          description: Количество элементов на одной странице
          type: integer
          format: int32
          example: 100

    WarehouseName:
      type: string
      minLength: 1
      maxLength: 256
      description: "Название склада"

    WarehouseAddress:
      type: string
      minLength: 1
      maxLength: 512
      description: "Адрес склада"

    Coordinates:
      type: object
      required:
        - latitude
        - longitude
      properties:
        latitude:
          type: number
          format: double
          minimum: -90
          maximum: 90
          description: "Широта"
        longitude:
          type: number
          format: double
          minimum: -180
          maximum: 180
          description: "Долгота"

    CreateWarehouseRequest:
      type: object
      required:
        - warehouse_name
        - address
        - coordinates
      properties:
        warehouse_name:
          $ref: "#/components/schemas/WarehouseName"
        address:
          $ref: "#/components/schemas/WarehouseAddress"
        coordinates:
          $ref: "#/components/schemas/Coordinates"

    CreateWarehouseResponse:
      type: object
      required:
        - id
      properties:
        id:
          type: string
          format: uuid

    GetWarehouseResponse:
      type: object
      properties:
        warehouse_id:
          $ref: "#/components/schemas/UUID"
        warehouse_name:
          $ref: "#/components/schemas/WarehouseName"
        address:
          $ref: "#/components/schemas/WarehouseAddress"
        coordinates:
          $ref: "#/components/schemas/Coordinates"

    UpdateWarehouseRequest:
      type: object
      required:
        - warehouse_id
        - warehouse_name
        - address
        - coordinates
      properties:
        warehouse_id:
          $ref: "#/components/schemas/UUID"
        warehouse_name:
          $ref: "#/components/schemas/WarehouseName"
        address:
          $ref: "#/components/schemas/WarehouseAddress"
        coordinates:
          $ref: "#/components/schemas/Coordinates"

    CreateOrderRequest:
      type: object
      required:
        - customerOrderId
        - payment
        - delivery
        - characteristic
      properties:
        customerOrderId:
          type: string
          description: "Идентификатор заказа в системе отправителя"
          example: "DO-2343423432"
        externalOrderId:
          type: string
          description: "Внешний идентификатор заказа"
          example: "EXT-2343423432"
        payment:
          $ref: "#/components/schemas/OrderPayment"
        delivery:
          $ref: "#/components/schemas/OrderDelivery"
        characteristic:
          $ref: "#/components/schemas/OrderCharacteristic"
        warehouseId:
          type: string
          format: uuid
          description: "Идентификатор склада партнёра"
        returnType:
          type: string
          description: "Тип возврата"
          enum:
            - "utilization"
            - "return"
          default: return
        returnWarehouseId:
          allOf:
            - $ref: "#/components/schemas/UUID"
          description: "Идентификатор склада возврата"

    CreateOrderResponse:
      type: object
      properties:
        trackingNumber:
          type: string
          description: "Трек-номер заказа. Используется для получения информации по заказу."
        customerOrderId:
          type: string
          description: "Идентификатор заказа в системе отправителя"
        status:
          $ref: "#/components/schemas/OrderStatus"
        payment:
          $ref: "#/components/schemas/OrderPayment"
        delivery:
          $ref: "#/components/schemas/OrderDelivery"
        characteristic:
          $ref: "#/components/schemas/OrderCharacteristic"
        cost:
          type: integer
          description: "Стоимость доставки в копейках"
        externalOrderId:
          type: string
          description: "Внешний идентификатор заказа"
          example: "EXT-2343423432"
        warehouseId:
          $ref: "#/components/schemas/UUID"

    OrderPayment:
      type: object
      required:
        - declaredValue
      properties:
        declaredValue:
          type: number
          description: "Заявленная стоимость"
          example: 153.28
          minimum: 1

    OrderDelivery:
      type: object
      required:
        - pickupPointKey
        - recipient
      properties:
        pickupPointKey:
          type: string
          example: "63933"
        recipient:
          $ref: "#/components/schemas/OrderDeliveryRecipient"

    OrderDeliveryRecipient:
      type: object
      required:
        - phoneNumber
      properties:
        firstName:
          type: string
          description: "Имя получателя"
          example: "Иван"
        familyName:
          type: string
          description: "Фамилия получателя"
          example: "Иванов"
        phoneNumber:
          type: string
          description: "Телефон получателя"
          example: "+7.........."
        email:
          type: string
          description: "Почта получателя"
          example: "test@mail.ru"
        address:
          type: string
          description: "Адрес получателя"
          example: "г. Казань, ул. Альфии Авзаловой, д. 7"

    OrderCharacteristic:
      type: object
      required:
        - weight
        - length
        - width
        - height
      properties:
        weight:
          type: integer
          description: "Вес посылки в граммах"
          example: 500
          minimum: 1
        length:
          type: integer
          description: "Длина посылки в миллиметрах"
          example: 200
          minimum: 1
        width:
          type: integer
          description: "Ширина посылки в миллиметрах"
          example: 150
          minimum: 1
        height:
          type: integer
          description: "Высота посылки в миллиметрах"
          example: 50
          minimum: 1

    OrderStatus:
      type: string
      description: "Статус заказа на доставку"
      enum:
        - "NEW"
        - "CREATED"
        - "DELIVERING_STARTED"
        - "ACCEPTED_AT_POINT"
        - "IN_COURIER_DELIVERY"
        - "ISSUED"
        - "DESTROYED"
        - "ACCEPTED_AT_WAREHOUSE"
        - "REMOVED"
        - "WAITING_RETURN"
        - "RETURN_INITIATED"
        - "RETURN_SEND_TO_WAREHOUSE"
        - "POSSIBLY_DEFECTED"
        - "DEFECTED"
        - "RETURN_ACCEPTED_AT_WAREHOUSE"
        - "RETURNED_TO_PROVIDER"
        - "CANCELED_BY_PROVIDER"
        - "ACCEPTED_AT_CUSTOMS"

    Order:
      type: object
      properties:
        trackingNumber:
          type: string
          nullable: true
          description: "Трек-номер заказа"
        customerOrderId:
          type: string
          nullable: true
          description: "Идентификатор заказа в системе отправителя"
        status:
          allOf:
            - $ref: "#/components/schemas/OrderStatus"
          nullable: true
        payment:
          allOf:
            - $ref: "#/components/schemas/OrderPayment"
          nullable: true
        delivery:
          allOf:
            - $ref: "#/components/schemas/OrderDelivery"
          nullable: true
        characteristic:
          allOf:
            - $ref: "#/components/schemas/OrderCharacteristic"
          nullable: true
        pickupCode:
          type: string
          nullable: true
          description: "Код для получения заказа"
        externalOrderId:
          type: string
          nullable: true
          description: "Идентификатор заказа для сверок"
        warehouseId:
          $ref: "#/components/schemas/UUID"
        createdAt:
          $ref: "#/components/schemas/DateTime"
        trackingLink:
          type: string
          description: 'Ссылка на отслеживание'
        fullTrackingLink:
          type: string
          description: 'Ссылка на отслеживание по полному трек номеру'
        storageEndDate:
          $ref: "#/components/schemas/DateTime"
          description: |
            Cрок хранения заказа на ПВЗ.
            Отображается только только в статусе ACCEPTED_AT_POINT

    GetOrdersResponse:
      type: object
      required:
        - orders
        - pager
      properties:
        orders:
          type: array
          items:
            $ref: "#/components/schemas/Order"
        pager:
          $ref: "#/components/schemas/Pager"

    GetOrderStatusesResponse:
      type: object
      required:
        - orderStatuses
        - ordersNotFound
      properties:
        orderStatuses:
          type: array
          items:
            type: object
            required:
              - trackingNumber
              - status
            properties:
              trackingNumber:
                $ref: "#/components/schemas/UUID"
              status:
                type: string
        ordersNotFound:
          type: array
          items:
            $ref: "#/components/schemas/UUID"

    DeliveryOrderHistoryResponse:
      type: object
      description: История изменения статусов заказа на доставку
      properties:
        trackingNumber:
          description: Трек-номер заказа
          type: string
        statuses:
          type: array
          items:
            type: object
            properties:
              status:
                $ref: "#/components/schemas/OrderStatus"
              timestamp:
                type: integer
                format: int64
                description: Время изменения статуса

    DateTime:
      type: string
      description: "Дата/время в формате (RFC3339 формат : %Y-%M-%DT%h:%m:%sZ)"
      example: "2023-03-20T15:04:05.000Z"
      format: date-time

    OrderV1Status:
      type: string
      description: "Статус заказа на доставку"
      enum:
        - "NEW"
        - "CREATED"
        - "DELIVERING_STARTED"
        - "ACCEPTED_AT_POINT"
        - "IN_COURIER_DELIVERY"
        - "ISSUED"
        - "DESTROYED"
        - "ACCEPTED_AT_WAREHOUSE"
        - "REMOVED"
        - "WAITING_RETURN"
        - "RETURN_INITIATED"
        - "RETURN_SEND_TO_WAREHOUSE"
        - "POSSIBLY_DEFECTED"
        - "DEFECTED"
        - "RETURN_ACCEPTED_AT_WAREHOUSE"
        - "RETURNED_TO_PROVIDER"
        - "CANCELED_BY_PROVIDER"
        - "ACCEPTED_AT_CUSTOMS"

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
